% Paper template for TAR 2022
% (C) 2014 Jan Šnajder, Goran Glavaš, Domagoj Alagić, Mladen Karan
% TakeLab, FER

\documentclass[10pt, a4paper, croatian]{article}

\usepackage{tar2023}

\usepackage[provide=*]{babel}

\usepackage[utf8]{inputenc}
\usepackage[pdftex]{graphicx}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{amssymb}

\title{Nadopunjavanje slike korištenjem difuzijskih modela}

\name{Martin Bakač, Mislav Đomlija, Ivan Kapusta, Maksim Kos, Antonio Lukić, Jerko Šegvić}

\address{
University of Zagreb, Faculty of Electrical Engineering and Computing\\
Unska 3, 10000 Zagreb, Croatia\\ 
}
          
         
\abstract{
Cilj nadopunjavanja slike je nedostajuće piksele slike zamijeniti čim uvjerljivijim sadržajem. U projektu smo opisali i implementirali model za nadopunjavanje slika temeljen na difuziji. Model je treniran na skupu podataka MNIST i ostvarili smo \textbf{TODO: ovakve i onakve rezultate}.
}

\begin{document}

\maketitleabstract

\section{Nadopunjavanje slike}
Nadopunjavnje slike (engl. \emph{image inpainting}) je postupak u kojem nadopunjavamo segmente slike koji nedostaju. Nadopuna mora biti 
semantički smislena i u skladnom odnosu s poznatim dijelom slike. Zbog ovih čvrstih zahtjeva, modeli za nadopunjavanje slike moraju imati 
snažne generativne mogućnosti. Generativni difuzijski modeli, uz dobre generativne sposobnosti, omogućuju i manipulaciju latentnog prostora 
za ugradnju semantičke informacije. Popularni modeli za ovaj zadatak su još i generativne suparničke mreže 
(engl. \emph{generative adverserial networks}) i autoregresivni modeli. Problem takvih arhitketura je da moraju također naučiti i distribuciju
dijelova slike koji nedostaju. U praksi takvi modeli imaju problema sa neobičnim prazninama u slici ili sa prazninama s kojima se nisu
susreli prilikom treniranja


\section{Difuzijski modeli}
Difuzijski modeli su su klasa generativnih modela s latentnim varijablama. Ideja difuzijskih modela je simulirati proces reverzne difuzije 
i naučiti model da iz poznate latentne distribucije konstruira elemente iz distribucije podataka. Svaki difuzijski model se sastoji od dva
osnovna elementa: unaprijedni proces i reverzni proces. Unaprijedni proces nema slobodne parametre, već se unaprijed definiranim 
transformacijama podatak postepeno pretvori u element latentne distribucije. Za distribuciju latentnog prostora odabrali smo normalnu razdiobu.
Dimenzija latentnog prostora jednaka je dimenziji prostora podatka. Unaprijedni proces može se promatrati kao markovljev lanac, i moguće je 
izvesti uvjetne distribuciju sljedećeg stanja na temelju trenutnog. Za distribuciju zadnjeg stanja lanca pretpostavljamo upravo latentnu 
distribuciju. Unatražnu distribuciju nije traktabilna te nju upravo procjenjujemo pomoću dubokog modela. 

\subsection{UNet}
\textbf{TODO}
\section{RePaint model}
RePaint je alogirtam za nadpounjavanje slike pomoću predtreniranog difuzijskog modela. Sam RePaint nema slobodne parametere te ga zato nije
potrebno učiti. To nam omogućava korištenje bilo kojeg difuzijskog modela. Također takav pristup nema pristranost prema nekim oblicima maski. 
Algoritam funkcionira na sljedeći način. Vidljivi dio slike unaprijednim prolazom preslikamo u stanje $x_t \sim p_t$ . Nadopunjenu sliku 
generiramo iz latentnog prostora do stanja $x_t \sim q_t$. Sada na nadopunjenu sliku primjenimo inverznu masku i ove dvije slike zbrojimo. 
Njihov zbroj jednak je novom "latentnom prostoru" iz kojeg generiramo novu nadopunjenu sliku. Ova iteracija se ponavlja dok se cijeli reverzni
proces ne izvrši to jest do $t = 0$

\section{Rezultati}

\section{Zaključak}

\textbf{TODO: ovo bude GPT na kraju napisal}

%\section*{Acknowledgements}

\bibliographystyle{tar2023}
\bibliography{tar2023} 

\end{document}

